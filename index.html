<!doctype html>
<html lang="si">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Mobile Friendly Form</title>

<style>
    body{
        font-family:Arial;
        padding:15px;
        background:#f0f3f7;
    }
    .box{
        background:#fff;
        padding:18px;
        border-radius:10px;
        max-width:480px;
        margin:auto;
        box-shadow:0 4px 12px rgba(0,0,0,0.08);
    }
    label{
        display:block;
        margin-top:10px;
        font-size:14px;
        color:#333;
    }
    input{
        width:100%;
        padding:12px;
        font-size:16px;
        border-radius:6px;
        border:1px solid #ccc;
        margin-top:5px;
    }

    /* Signature Box */
    #sig-box{
        margin-top:12px;
        border:2px dashed #aaa;
        border-radius:8px;
        background:#fff;
        padding:10px;
        touch-action: none; /* prevents scrolling while drawing */
    }

    #sig{
        width:100%;
        height:200px;   /* Mobile-friendly height */
        background:#fff;
        border-radius:6px;
        touch-action: none;
    }

    button{
        width:100%;
        padding:12px;
        margin-top:12px;
        font-size:17px;
        border:none;
        border-radius:8px;
        background:#007bff;
        color:#fff;
    }
    button.secondary{
        background:#555;
    }

    /* Result box */
    #result{
        display:none;
        margin-top:20px;
        background:#fff;
        padding:18px;
        border-radius:10px;
        border:1px solid #ccc;
        max-width:480px;
        margin:auto;
    }

    .declaration{
        margin-top:15px;
        background:#f7f9fc;
        padding:12px;
        border-radius:8px;
        font-size:14px;
        line-height:1.6;
        border:1px solid #dce3ee;
    }
</style>
</head>

<body>

<div class="box">
    <h3>Flexico – ණය තහවුරු කිරීම</h3>

    <label>නම</label>
    <input id="name" type="text">

    <label>මුදල</label>
    <input id="amount" type="text">

    <label>NIC</label>
    <input id="nic" type="text">

    <!-- DECLARATION SECTION ADDED -->
    <div class="declaration">
        මෙම ණය මුදල මා විසින් ලබා ගන්නා අතර කිසිදු වංචාවක් හෝ පෙරහැරීමක් නොකරන මා විසින් පොරොන්දු වෙමි.<br><br>
        එහෙම පැහැරහැරීමක් කිරීමක් හෝ කිසියම් වංචාවක් කලහොත් මා විසින් වගකීම ලබා ගන්නා බව පොරොන්දු වේ.
    </div>

    <label>අත්සන්</label>
    <div id="sig-box">
        <canvas id="sig"></canvas>
    </div>

    <button onclick="submitForm()">Submit</button>
    <button class="secondary" onclick="clearSig()">Clear Signature</button>
</div>


<div id="result">
    <h4>ඉල්ලීම් විස්තර</h4>

    <p><b>නම:</b> <span id="r_name"></span></p>
    <p><b>මුදල:</b> <span id="r_amount"></span></p>
    <p><b>NIC:</b> <span id="r_nic"></span></p>
    <p><b>අත්සන:</b></p>
    <img id="r_sig" style="width:200px;border:1px solid #666;">
</div>

<script>
// AUTO RESIZE CANVAS FOR MOBILE
const canvas = document.getElementById("sig");
const ctx = canvas.getContext("2d");

function resizeCanvas(){
    const box = document.getElementById("sig-box");
    canvas.width = box.clientWidth;
    canvas.height = 200;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// MOBILE DRAWING SUPPORT
let drawing = false;

function getPos(e){
    const rect = canvas.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
    return {x, y};
}

canvas.addEventListener("touchstart", e => {
    e.preventDefault();
    drawing = true;
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
});

canvas.addEventListener("touchmove", e => {
    if(!drawing) return;
    e.preventDefault();
    const p = getPos(e);
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
    ctx.strokeStyle = "#000";
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
});

canvas.addEventListener("touchend", ()=> drawing = false);

// MOUSE SUPPORT
canvas.addEventListener("mousedown", e => {
    drawing = true;
    const p = getPos(e);
    ctx.beginPath();
    ctx.moveTo(p.x, p.y);
});
canvas.addEventListener("mousemove", e => {
    if(!drawing) return;
    const p = getPos(e);
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
    ctx.strokeStyle = "#000";
    ctx.lineTo(p.x, p.y);
    ctx.stroke();
});
canvas.addEventListener("mouseup", ()=> drawing = false);

function clearSig(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
}

function submitForm(){
    let name = document.getElementById("name").value;
    let amount = document.getElementById("amount").value;
    let nic = document.getElementById("nic").value;

    if(!name || !amount || !nic){
        alert("සියලු විස්තර ඇතුල් කරන්න");
        return;
    }

    document.getElementById("r_name").innerText = name;
    document.getElementById("r_amount").innerText = amount;
    document.getElementById("r_nic").innerText = nic;

    const sigImg = canvas.toDataURL("image/png");
    document.getElementById("r_sig").src = sigImg;

    document.getElementById("result").style.display = "block";

    window.scrollTo({top: document.body.scrollHeight, behavior:"smooth"});
}
</script>

</body>
</html>
